import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,a,d as t,e as n,o as l}from"./app-WyckBTYZ.js";const d={};function h(r,i){return l(),e("div",null,[i[0]||(i[0]=a("p",null,"redis çš„æ•°æ®åœ¨å†…å­˜ä¸­çš„ç»„ç»‡è¿‡ç¨‹",-1)),t(" more "),i[1]||(i[1]=n(`<h1 id="å‰è¨€" tabindex="-1"><a class="header-anchor" href="#å‰è¨€"><span>å‰è¨€</span></a></h1><p>æœ¬æ–‡ä¸å¯¹ redis çš„æ•°æ®å¯¹è±¡ä»¥åŠåº•å±‚ç¼–ç æ–¹å¼ä½œæ·±å…¥å±•å¼€ã€‚ ä»…æ˜¯ä»¥ <strong>å±€éƒ¨åˆ°å…¨æ™¯</strong> çš„æ€è·¯ç®€å•ç†è§£ <strong>redis çš„æ•°æ®åœ¨å†…å­˜ä¸­çš„ç»„ç»‡è¿‡ç¨‹</strong>ã€‚</p><h1 id="æ¨èå­¦ä¹ " tabindex="-1"><a class="header-anchor" href="#æ¨èå­¦ä¹ "><span>æ¨èå­¦ä¹ </span></a></h1><ul><li><a href="https://xiaolincoding.com/redis/" target="_blank" rel="noopener noreferrer">å°æ—coding å›¾è§£redis</a></li><li><a href="https://doc.yonyoucloud.com/doc/wiki/project/redis/index.html" target="_blank" rel="noopener noreferrer">Redis æºç æ—¥å¿—</a></li></ul><h1 id="ä¸€ã€ç†è§£-k-v-åœ¨å†…å­˜ä¸­çš„å­˜å‚¨å½¢å¼" tabindex="-1"><a class="header-anchor" href="#ä¸€ã€ç†è§£-k-v-åœ¨å†…å­˜ä¸­çš„å­˜å‚¨å½¢å¼"><span>ä¸€ã€ç†è§£ k-v åœ¨å†…å­˜ä¸­çš„å­˜å‚¨å½¢å¼</span></a></h1><h2 id="_1-1-å­˜å‚¨å½¢å¼ä¸º-redisobject" tabindex="-1"><a class="header-anchor" href="#_1-1-å­˜å‚¨å½¢å¼ä¸º-redisobject"><span>1.1 å­˜å‚¨å½¢å¼ä¸º redisObject</span></a></h2><p>redis æ˜¯ <strong>é”®å€¼å¯¹</strong> å­˜å‚¨ï¼Œkey å’Œ value åœ¨ redis ä¸­è¢«æŠ½è±¡ä¸ºredisObjectï¼Œå³å¯¹è±¡ã€‚</p><ul><li><code>key</code>ï¼š åªèƒ½æ˜¯ string å¯¹è±¡ã€‚</li><li><code>value</code>ï¼š æ”¯æŒä¸°å¯Œçš„å¯¹è±¡ç§ç±»ï¼ŒåŒ…æ‹¬ï¼šstringã€listã€setã€hashã€zsetç­‰ã€‚</li></ul><h2 id="_1-2-redisobject-ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1-2-redisobject-ç»“æ„"><span>1.2 redisObject ç»“æ„</span></a></h2><p>é‡ç‚¹å…³æ³¨ type å’Œ encoding å­—æ®µã€‚</p><ul><li><code>type</code>ï¼šè¡¨æ˜æ˜¯å“ªç§ redis æ•°æ®å¯¹è±¡ã€‚</li><li><code>encoding</code>ï¼šè¡¨æ˜æ•°æ®å¯¹è±¡çš„åº•å±‚ç¼–ç æ–¹å¼ï¼ˆåº•å±‚æ•°æ®ç»“æ„ï¼‰ã€‚å¯ä»¥çœ‹åˆ°ä¸åŒçš„æ•°æ®å¯¹è±¡ï¼Œå¯èƒ½é‡‡ç”¨ç›¸åŒçš„ç¼–ç æ–¹å¼ã€‚</li></ul><figure><img src="http://images.kryiea.cn/img/2.png" alt="2" tabindex="0" loading="lazy"><figcaption>2</figcaption></figure><h2 id="_1-3-å®é™…ä¾‹å­" tabindex="-1"><a class="header-anchor" href="#_1-3-å®é™…ä¾‹å­"><span>1.3 å®é™…ä¾‹å­</span></a></h2><p>å­˜ä¸€æ¡æ•°æ®ï¼Œredis å‘½ä»¤ï¼š<code>set æˆ‘æ˜¯ä¸€ä¸ªkey 1000</code></p><p>redisObject è¡¨ç°ä¸ºğŸ‘‡</p><p><strong><code>key = â€œæˆ‘æ˜¯ä¸€ä¸ªkeyâ€ </code>ï¼Œ Object çš„å›¾ç¤ºï¼ˆå‡è®¾ç”¨embstrç¼–ç ï¼‰ï¼š</strong></p><figure><img src="http://images.kryiea.cn/img/3.png" alt="3" tabindex="0" loading="lazy"><figcaption>3</figcaption></figure><p><strong><code>value = 1000 </code>ï¼ŒObject çš„å›¾ç¤ºï¼ˆå‡è®¾ç”¨ç¼–ç intï¼‰ï¼š</strong></p><figure><img src="http://images.kryiea.cn/img/4.png" alt="4" tabindex="0" loading="lazy"><figcaption>4</figcaption></figure><h2 id="_1-3-redisobject-ä»£ç " tabindex="-1"><a class="header-anchor" href="#_1-3-redisobject-ä»£ç "><span>1.3 redisObject ä»£ç </span></a></h2><p>é™¤äº† type å’Œ encoding å­—æ®µå¤–ï¼Œ</p><ul><li><code>lru</code>ï¼šè®°å½•å¯¹è±¡è®¿é—®ä¿¡æ¯ï¼Œç”¨äºå†…å­˜æ·˜æ±°ï¼ˆlruã€lfu éƒ½å¤ç”¨è¿™ä¸ªå­—æ®µï¼‰</li><li><code>refcount</code>ï¼šå¼•ç”¨è®¡æ•°ï¼Œç”¨æ¥æè¿°æœ‰å‡ ä¸ªæŒ‡é’ˆæŒ‡å‘è¯¥å¯¹è±¡</li><li><code>ptr</code>ï¼šå†…å®¹æŒ‡é’ˆï¼ŒæŒ‡å‘å®é™…æ•°æ®</li></ul><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// redis 6.0.10</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> redisObject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    unsigned</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    unsigned</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> encoding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    unsigned</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> lru</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">LRU_BITS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">/* LRU time (relative to global lru_clock) or</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            * LFU data (least significant 8 bits frequency</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            * and most significant 16 bits access time). */</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> refcount</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    void</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ptr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="äºŒã€ç†è§£-redisobject-çš„ç»„ç»‡å½¢å¼" tabindex="-1"><a class="header-anchor" href="#äºŒã€ç†è§£-redisobject-çš„ç»„ç»‡å½¢å¼"><span>äºŒã€ç†è§£ redisObject çš„ç»„ç»‡å½¢å¼</span></a></h1><p>ä»ä¸Šé¢äº†è§£åˆ° k-v åœ¨å†…å­˜é‡Œçš„å­˜å‚¨å½¢å¼ä¸º redisObjectï¼Œé‚£è¿™äº› Object åˆæ˜¯è¢«å¦‚ä½•ç»„ç»‡ç®¡ç†çš„å‘¢ï¼Ÿ</p><p><strong>è‡ªç„¶æ˜¯</strong> <code>dict</code></p><h2 id="_2-1-dict-ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_2-1-dict-ç»“æ„"><span>2.1 dict ç»“æ„</span></a></h2><blockquote><p>ç®€å•è§†è§’ç†è§£ dict ç®¡ç† redisObject</p></blockquote><p>ç®€å•æ¥è¯´ï¼Œ<strong>dict æ˜¯ä¸€å¼ å“ˆå¸Œè¡¨</strong>ï¼ŒRedis æ‰€æœ‰çš„ key-value éƒ½å­˜å‚¨åœ¨é‡Œé¢ã€‚</p><figure><img src="http://images.kryiea.cn/img/dict.png" alt="dict" tabindex="0" loading="lazy"><figcaption>dict</figcaption></figure><blockquote><p>æ·±å…¥ä¸€ç‚¹ç†è§£ dict ç®¡ç† redisObject</p></blockquote><p>dict åœ¨ redis ä¸­ä¼šæœ‰æ›´å¤šå±‚çš„æŠ½è±¡ï¼Œä»¥ä¾¿å®ç°æ›´å¤šåŠŸèƒ½ã€‚</p><figure><img src="http://images.kryiea.cn/img/dict+.png" alt="dict+" tabindex="0" loading="lazy"><figcaption>dict+</figcaption></figure><h2 id="_2-2-dict-ä»£ç " tabindex="-1"><a class="header-anchor" href="#_2-2-dict-ä»£ç "><span>2.2 dict ä»£ç </span></a></h2><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// å“ˆå¸Œè¡¨ï¼ˆå­—å…¸ï¼‰æ•°æ®ç»“æ„ï¼ŒRedis çš„æ‰€æœ‰é”®å€¼å¯¹éƒ½ä¼šå­˜å‚¨åœ¨è¿™é‡Œã€‚å…¶ä¸­åŒ…å«ä¸¤ä¸ªå“ˆå¸Œè¡¨ã€‚</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> dict</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // å“ˆå¸Œè¡¨çš„ç±»å‹ï¼ŒåŒ…æ‹¬å“ˆå¸Œå‡½æ•°ï¼Œæ¯”è¾ƒå‡½æ•°ï¼Œé”®å€¼çš„å†…å­˜é‡Šæ”¾å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    dictType</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // å­˜å‚¨ä¸€äº›é¢å¤–çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    void</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">privdata</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ä¸¤ä¸ªå“ˆå¸Œè¡¨ï¼Œå…ˆä½¿ç”¨ht[0],æ‰©å®¹æ—¶å¯ç”¨ht[1]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    dictht</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> ht</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // å“ˆå¸Œè¡¨é‡ç½®ä¸‹æ ‡ï¼ŒæŒ‡å‘çš„æ˜¯å“ˆå¸Œæ•°ç»„çš„æ•°ç»„ä¸‹æ ‡ï¼Œæ‰©å®¹æ—¶ä½¿ç”¨ã€‚</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> rehashidx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ç»‘å®šåˆ°å“ˆå¸Œè¡¨çš„è¿­ä»£å™¨ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> iterators</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="ä¸‰ã€-ç†è§£-dict-çš„ç»„ç»‡å½¢å¼" tabindex="-1"><a class="header-anchor" href="#ä¸‰ã€-ç†è§£-dict-çš„ç»„ç»‡å½¢å¼"><span>ä¸‰ã€ ç†è§£ dict çš„ç»„ç»‡å½¢å¼</span></a></h1><p>dict ç®¡ç†å­˜å‚¨çš„ redisObjectï¼Œé‚£è°æ¥ç»„ç»‡ dict å‘¢ï¼Ÿ <strong>è‡ªç„¶æ˜¯å†ä¸Šä¸€å±‚çš„æŠ½è±¡ï¼š<code>redisDB</code></strong></p><h2 id="_3-1-redisdb-ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_3-1-redisdb-ç»“æ„"><span>3.1 redisDB ç»“æ„</span></a></h2><p>redisDB çš„é‡ç‚¹å­—æ®µ</p><ul><li><code>id</code>ï¼šredis å¯åŠ¨æ—¶é»˜è®¤å¼€å¯ 16 ä¸ª DBï¼Œå¯¹åº”<code>0-15</code> ç¼–å·ã€‚å¯é…ç½®ã€‚</li><li><code>dict</code>ï¼šæŒ‡å‘ä¸€ä¸ª dictã€‚</li><li><code>expires</code>ï¼šæŒ‡å‘ä¸€ä¸ª dictï¼Œè¯¥ dict å­˜å‚¨<code>å«è¿‡æœŸæ—¶é—´çš„ k-v</code>ã€‚</li></ul><figure><img src="http://images.kryiea.cn/img/redisdb.png" alt="redisdb" tabindex="0" loading="lazy"><figcaption>redisdb</figcaption></figure><h2 id="_3-2-redisdb-ä»£ç " tabindex="-1"><a class="header-anchor" href="#_3-2-redisdb-ä»£ç "><span>3.2 redisDb ä»£ç </span></a></h2><div class="language-go line-numbers-mode" data-highlighter="shiki" data-ext="go" data-title="go" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> redisDb</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;                     </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// æ•°æ®åº“ID</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    dict</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dict</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;                 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// è¯¥æ•°æ®åº“çš„é”®ç©ºé—´</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    dict</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">expires</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;              </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// è®¾ç½®äº†è¶…æ—¶çš„é”®çš„è¶…æ—¶æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    dict</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">blocking_keys</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;        </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// æœ‰å®¢æˆ·ç«¯ç­‰å¾…æ•°æ®çš„é”®ï¼ˆBLPOPï¼‰</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    dict</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ready_keys</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;           </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// æ¥æ”¶åˆ°PUSHæ“ä½œçš„é˜»å¡é”®</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    dict</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">watched_keys</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;         </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// ç”¨äºMULTI/EXEC CASçš„ç›‘è§†é”®</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> avg_ttl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;          </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// å¹³å‡ç”Ÿå­˜æ—¶é—´ï¼ˆTTLï¼‰ï¼Œä»…ç”¨äºç»Ÿè®¡</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    unsigned</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> expires_cursor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// æ´»è·ƒè¿‡æœŸå‘¨æœŸçš„æ¸¸æ ‡ã€‚</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    list</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">defrag_later</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;         </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// ç¨åå°è¯•é€ä¸ªã€é€æ¸è¿›è¡Œç¢ç‰‡æ•´ç†çš„é”®ååˆ—è¡¨ã€‚</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="å››ã€redis-ç»„ç»‡å½¢å¼å…¨æ™¯" tabindex="-1"><a class="header-anchor" href="#å››ã€redis-ç»„ç»‡å½¢å¼å…¨æ™¯"><span>å››ã€redis ç»„ç»‡å½¢å¼å…¨æ™¯</span></a></h1><p>ç»è¿‡ä¸Šé¢å¯¹ redisObjectã€dictã€redisDB çš„å±‚å±‚ç†è§£ï¼Œå¯¹ redis æœ‰äº†ç»“æ„åŒ–ã€å±‚æ¬¡åŒ–çš„ç†è§£ã€‚</p><p>æ¥ä¸‹æ¥ä»¥å…¨æ™¯çš„è§†è§’æ¥çœ‹ redis çš„ç»„ç»‡å½¢å¼</p><figure><img src="http://images.kryiea.cn/img/redis.drawio.png" alt="redis.drawio" tabindex="0" loading="lazy"><figcaption>redis.drawio</figcaption></figure><p>é‡ç‚¹ç»“æ„ï¼š</p><ul><li><code>redisDB</code>ï¼šé»˜è®¤æ˜¯æœ‰ 0-15 ç¼–å·ï¼Œå…± 16 ä¸ª DB ï¼Œé»˜è®¤æ˜¯é€‰æ‹© 0 å·ã€‚</li><li><code>dict</code>ï¼šå¯¹ hashtable çš„ä¸€å±‚å°è£…ï¼Œæ·»åŠ  k-v çš„åœ°æ–¹</li><li><code>hashtable</code>ï¼šå¯¹ dictEntry çš„ä¸€å±‚å°è£…ï¼Œå­˜æœ‰ table çš„åœ°å€</li><li><code>dictEntry(bucket)</code>ï¼šå­˜å‚¨ key-value å¯¹è±¡ã€‚</li><li><code>redisObject</code>ï¼šæ¯ä¸ª key å’Œ value éƒ½è¡¨ç°ä¸ºä¸€ä¸ª redisObject å¯¹è±¡</li></ul><h2 id="_4-1-redis-å“ˆå¸Œå†²çªå¦‚ä½•è§£å†³" tabindex="-1"><a class="header-anchor" href="#_4-1-redis-å“ˆå¸Œå†²çªå¦‚ä½•è§£å†³"><span>4.1 redis å“ˆå¸Œå†²çªå¦‚ä½•è§£å†³</span></a></h2><p>redis ä¾é  dict å“ˆå¸Œè¡¨æ¥ç»„ç»‡æ‰€æœ‰çš„ k-v å¯¹è±¡ã€‚</p><p>æ¯æ¬¡æ·»åŠ  k-v çš„æ—¶å€™ï¼Œéœ€è¦è¿›è¡Œ <code>hashè¿ç®—</code> ä»¥åŠ <code>æ©ç è¿ç®—</code> æ¥æ‰¾åˆ°å¯¹åº”çš„æ’å…¥ä½ç½®ï¼Œè¿™æ—¶å¯èƒ½ä¼šå‘ç”Ÿå“ˆå¸Œå†²çªã€‚</p><p>redis ç”¨<code>å˜ç§æ‹‰é“¾æ³•</code>æ¥è§£å†³å“ˆå¸Œå†²çªï¼Œå…¨æ™¯å›¾çš„ <code>dictEntry</code> ç»“æ„æœ‰ä¸€ä¸ª <code>next</code> å­—æ®µï¼Œ<strong>æŒ‡å‘å†²çªçš„ä¸‹ä¸€å¯¹ k-v</strong></p><figure><img src="http://images.kryiea.cn/img/hash.png" alt="hash" tabindex="0" loading="lazy"><figcaption>hash</figcaption></figure><h2 id="_4-2-redisdb-çš„-expires" tabindex="-1"><a class="header-anchor" href="#_4-2-redisdb-çš„-expires"><span>4.2 redisDB çš„ expires</span></a></h2><p>åœ¨å…¨æ™¯å›¾çš„ <code>redisDB</code> ç»“æ„ä¸­ï¼Œå¯ä»¥å‘ç° <code>*dict ã€*expires</code> éƒ½æ˜¯æŒ‡å‘ä¸€ä¸ªdict ç»“æ„ã€‚</p><p>ä½† expires æ‰€æŒ‡å‘çš„ dict åœ¨ç»„ç»‡å½¢å¼ä¸Šä¼šæœ‰æ‰€å·®å¼‚ï¼š</p><ul><li>dict å’Œ expires ä¸­çš„ key å¯¹è±¡ï¼Œå®é™…éƒ½æ˜¯å­˜å‚¨äº† <code>string å¯¹è±¡çš„æŒ‡é’ˆ</code>ï¼Œæ‰€ä»¥æ˜¯ä¸ä¼šé‡å¤å ç”¨å†…å­˜ã€‚</li><li>å¦‚æœè®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œkey çš„æŒ‡é’ˆ åœ¨ dict å’Œ expires éƒ½ä¼šå­˜å‚¨ä¸€ä»½ã€‚åªæ˜¯ expires ä¸­ value æŒ‡å‘ timestampï¼ˆè¿‡æœŸæ—¶é—´ï¼‰ï¼Œè€Œ dict çš„ value æŒ‡å‘å®é™…æ•°æ®ã€‚</li></ul><figure><img src="http://images.kryiea.cn/img/expires.png" alt="expires" tabindex="0" loading="lazy"><figcaption>expires</figcaption></figure>`,59))])}const c=s(d,[["render",h],["__file","dataInMemory.html.vue"]]),g=JSON.parse('{"path":"/back-end/redis/basis/dataInMemory.html","title":"redisæ•°æ®åœ¨å†…å­˜ä¸­çš„ç»„ç»‡è¿‡ç¨‹","lang":"zh-CN","frontmatter":{"title":"redisæ•°æ®åœ¨å†…å­˜ä¸­çš„ç»„ç»‡è¿‡ç¨‹","cover":null,"icon":null,"order":1,"author":null,"category":["redis"],"tag":["redis"],"sticky":false,"star":null,"footer":null,"copyright":null,"description":"redis çš„æ•°æ®åœ¨å†…å­˜ä¸­çš„ç»„ç»‡è¿‡ç¨‹","head":[["meta",{"property":"og:url","content":"https://kryiea.cn/kryiea.github.io/back-end/redis/basis/dataInMemory.html"}],["meta",{"property":"og:site_name","content":"ğŸ§kryiea"}],["meta",{"property":"og:title","content":"redisæ•°æ®åœ¨å†…å­˜ä¸­çš„ç»„ç»‡è¿‡ç¨‹"}],["meta",{"property":"og:description","content":"redis çš„æ•°æ®åœ¨å†…å­˜ä¸­çš„ç»„ç»‡è¿‡ç¨‹"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"http://images.kryiea.cn/img/2.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-12-04T10:00:52.000Z"}],["meta",{"property":"article:tag","content":"redis"}],["meta",{"property":"article:modified_time","content":"2024-12-04T10:00:52.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"redisæ•°æ®åœ¨å†…å­˜ä¸­çš„ç»„ç»‡è¿‡ç¨‹\\",\\"image\\":[\\"http://images.kryiea.cn/img/2.png\\",\\"http://images.kryiea.cn/img/3.png\\",\\"http://images.kryiea.cn/img/4.png\\",\\"http://images.kryiea.cn/img/dict.png\\",\\"http://images.kryiea.cn/img/dict+.png\\",\\"http://images.kryiea.cn/img/redisdb.png\\",\\"http://images.kryiea.cn/img/redis.drawio.png\\",\\"http://images.kryiea.cn/img/hash.png\\",\\"http://images.kryiea.cn/img/expires.png\\"],\\"dateModified\\":\\"2024-12-04T10:00:52.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"kryiea\\",\\"url\\":\\"https://github.com/kryiea\\",\\"email\\":\\"kryieaa@outlook.com\\"}]}"]]},"headers":[{"level":2,"title":"1.1 å­˜å‚¨å½¢å¼ä¸º redisObject","slug":"_1-1-å­˜å‚¨å½¢å¼ä¸º-redisobject","link":"#_1-1-å­˜å‚¨å½¢å¼ä¸º-redisobject","children":[]},{"level":2,"title":"1.2 redisObject ç»“æ„","slug":"_1-2-redisobject-ç»“æ„","link":"#_1-2-redisobject-ç»“æ„","children":[]},{"level":2,"title":"1.3 å®é™…ä¾‹å­","slug":"_1-3-å®é™…ä¾‹å­","link":"#_1-3-å®é™…ä¾‹å­","children":[]},{"level":2,"title":"1.3 redisObject ä»£ç ","slug":"_1-3-redisobject-ä»£ç ","link":"#_1-3-redisobject-ä»£ç ","children":[]},{"level":2,"title":"2.1 dict ç»“æ„","slug":"_2-1-dict-ç»“æ„","link":"#_2-1-dict-ç»“æ„","children":[]},{"level":2,"title":"2.2 dict ä»£ç ","slug":"_2-2-dict-ä»£ç ","link":"#_2-2-dict-ä»£ç ","children":[]},{"level":2,"title":"3.1 redisDB ç»“æ„","slug":"_3-1-redisdb-ç»“æ„","link":"#_3-1-redisdb-ç»“æ„","children":[]},{"level":2,"title":"3.2 redisDb ä»£ç ","slug":"_3-2-redisdb-ä»£ç ","link":"#_3-2-redisdb-ä»£ç ","children":[]},{"level":2,"title":"4.1 redis å“ˆå¸Œå†²çªå¦‚ä½•è§£å†³","slug":"_4-1-redis-å“ˆå¸Œå†²çªå¦‚ä½•è§£å†³","link":"#_4-1-redis-å“ˆå¸Œå†²çªå¦‚ä½•è§£å†³","children":[]},{"level":2,"title":"4.2 redisDB çš„ expires","slug":"_4-2-redisdb-çš„-expires","link":"#_4-2-redisdb-çš„-expires","children":[]}],"git":{"createdTime":1733306452000,"updatedTime":1733306452000,"contributors":[{"name":"kryiea","email":"1582877056@qq.com","commits":1}]},"readingTime":{"minutes":4.59,"words":1377},"filePathRelative":"back-end/redis/basis/dataInMemory.md","localizedDate":"2024å¹´12æœˆ4æ—¥","excerpt":"<p>redis çš„æ•°æ®åœ¨å†…å­˜ä¸­çš„ç»„ç»‡è¿‡ç¨‹</p>\\n","autoDesc":true}');export{c as comp,g as data};
